<!-- Turbine transfers-->
<div class="col-xl-12 col-lg-24" *ngIf="gangwayActive">
  <div class="card mb-3">
    <div class="card-header">
      Turbine transfers
    </div>
    <div class="card-body table-responsive">
      <table class="table table-hover table-striped">
        <thead>
          <tr>
            <th>Location</th>
            <th>Safety zone entry</th>
            <th>Safety zone exit</th>
            <ng-template #helpDurationSafetyZone class="helpContent">
              Minutes between entering safety zone, performing the transfer, and once
              again leaving the safety zone
            </ng-template>
            <th [ngbTooltip]="helpDurationSafetyZone" placement="top" container="body">
              Duration in safety zone</th>
            <ng-template #helpGangwayUtil class="helpContent">
              Performance of gangway relative to its performance limitations.
            </ng-template>
            <th [ngbTooltip]="helpGangwayUtil" placement="top" container="body">Gangway
              capacity [%]</th>
            <th>Pax in/out</th>
            <th>Cargo in/out</th>
            <th>Peak gust wind</th>
            <th>Hs [m]</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let turbineTransfer of turbineTransfers">
            <tr>
              <th>{{turbineTransfer.location}}</th>
              <td>{{getMatlabDateToCustomJSTime(turbineTransfer.startTime, 'HH:mm')}}</td>
              <td>{{getMatlabDateToCustomJSTime(turbineTransfer.stopTime, 'HH:mm')}}</td>
              <td>{{turbineTransfer.duration}} minutes</td>
              <td>{{GetDecimalValueForNumber(turbineTransfer.gangwayUtilisation, '%')}}
              </td>
              <td>
                <input type="number" min="0" class="form-control-sm col-sm-5" [(ngModel)]="turbineTransfer.paxIn"
                  (ngModelChange)="updatePaxCargoTotal()"> incoming <br>
                <input type="number" min="0" class="form-control-sm col-sm-5" [(ngModel)]="turbineTransfer.paxOut"
                  (ngModelChange)="updatePaxCargoTotal()"> outgoing
              </td>
              <td>
                <input type="number" min="0" class="form-control-sm col-sm-5" [(ngModel)]="turbineTransfer.cargoIn"
                  (ngModelChange)="updatePaxCargoTotal()"> kg incoming <br>
                <input type="number" min="0" class="form-control-sm col-sm-5" [(ngModel)]="turbineTransfer.cargoOut"
                  (ngModelChange)="updatePaxCargoTotal()"> kg outgoing
              </td>
              <td>{{turbineTransfer.peakWindGust}}</td>
              <td>{{GetDecimalValueForNumber(turbineTransfer.Hs)}}</td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>
<!-- gangway transfers -->
<div class="col-xl-12 col-lg-24" *ngIf="gangwayActive">
  <div class="card mb-3">
    <div class="card-header">
      Gangway usage
    </div>
    <div class="card-body table-responsive">
      <table class="table table-hover table-striped">
        <thead>
          <tr>
            <th>Location</th>
            <ng-template #helpGangwayReady class="helpContent">
              Starttime indicating the gangway is attached and ready for transfers
            </ng-template>
            <th [ngbTooltip]="helpGangwayReady" placement="top" container="body">Gangway ready
            </th>
            <th>Gangway disengaged</th>
            <ng-template #helpGangwayReadyDuaration class="helpContent">
              Duration for which gangway is attached and ready for transfer
            </ng-template>
            <th [ngbTooltip]="helpGangwayReadyDuaration" placement="top" container="body">Ready duration
              [mns]</th>
            <ng-template #helpGangwayReadyDeployed class="helpContent">
              Duration for which the gangway was used active this tranfer, not just ready to
              tranfers
            </ng-template>
            <th [ngbTooltip]="helpGangwayReadyDeployed" placement="top" container="body">
              Deployed duration [mns]</th>
            <ng-template #helpGangwayUtil class="helpContent">
              Performance of gangway relative to its performance limitations.
            </ng-template>
            <th [ngbTooltip]="helpGangwayUtil" placement="top" container="body">Gangway capacity
              [%]</th>
            <ng-template #helpGangwayLimiter class="helpContent">
              Indicates which part is the most limiting parameter for gangway utilisation.
            </ng-template>
            <th [ngbTooltip]="helpGangwayLimiter" placement="top" container="body">Limiter</th>
        </thead>
        <tbody>
          <tr *ngFor="let turbineTransfer of turbineTransfers">
            <th>{{turbineTransfer.location}}</th>
            <td>{{getMatlabDateToCustomJSTime(turbineTransfer.timeGangwayReady, 'HH:mm')}}
            </td>
            <td>{{getMatlabDateToCustomJSTime(turbineTransfer.timeGangwayRetracted, 'HH:mm')}}
            </td>
            <td>{{GetMatlabDurationToMinutes(turbineTransfer.gangwayReadyDuration)}}</td>
            <td>{{GetMatlabDurationToMinutes(turbineTransfer.gangwayDeployedDuration)}}</td>
            <td>{{GetDecimalValueForNumber(turbineTransfer.gangwayUtilisation, '%')}}</td>
            <td>{{turbineTransfer.gangwayUtilisationLimiter}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
<!-- Cycle times -->
<div class="row" *ngIf="cycleTimes.length > 0">
  <div class="col-xl-12 col-lg-24">
    <div class="card mb-3">
      <div class="card-header">
        Cycle Times
      </div>
      <div class="card-body table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>From turbine</th>
              <th>To turbine</th>
              <th colspan="2">Start time</th>
              <th>Duration</th>
              <th>Sailed distance</th>
              <th>Turbine distance</th>
              <th>Average speed</th>
              <th>Maximum speed</th>
              <th>Transfer time [mns]</th>
              <ng-template #helpCycleAbove5Knots class="helpContent">
                Percentage of time spend travelling above 5 knots.
              </ng-template>
              <th [ngbTooltip]="helpCycleAbove5Knots" placement="top" container="body">Speed above
                5 kts</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let cycleTime of cycleTimes">
              <tr>
                <th>{{cycleTime.fromTurbine}}</th>
                <th>{{cycleTime.toTurbine}}</th>
                <td colspan="2">{{getMatlabDateToCustomJSTime(cycleTime.startTimeNum, 'HH:mm')}}
                </td>
                <td>{{GetMatlabDurationToMinutes(cycleTime.durationMinutes)}}</td>
                <td>{{cycleTime.sailedDistance}}</td>
                <td>{{cycleTime.turbineDistance}}</td>
                <td>{{cycleTime.avgSpeed}}</td>
                <td>{{cycleTime.maxSpeed}}</td>
                <td>{{GetDecimalValueForNumber(cycleTime.transferTimeMins, ' minutes')}}</td>
                <td>{{GetDecimalValueForNumber(100 * cycleTime.movingSpeedAbove5ktsPerc, '%')}}
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>