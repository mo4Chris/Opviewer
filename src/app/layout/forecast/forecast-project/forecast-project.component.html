
<h2>Selected project id: {{project_id}}</h2>

<div class="row">
  <div class="col-md-6">
    <div class='card mb-3'>
      <div class='card-header'>
        Project description
      </div>
      <div class='card-body table-responsive'>
        <table class='table table-hover table-striped'>
          <tbody class='sep-row'>
            <tr>
              <td>Name</td>
              <td colspan="2" *ngIf="permission.createProject"><input [(ngModel)]="project.name"></td>
              <td colspan="2" *ngIf="!permission.createProject">{{project.name}}</td>
            </tr>
            <tr>
              <td>Client</td>
              <td colspan="2">{{project.client_id || 'N/a'}}</td>
            </tr>
            <tr>
              <td>Span</td>
              <td colspan="2">{{contractStartDateString}} - {{contractEndDateString}}</td>
            </tr>
            <tr>
              <td>Latitude</td>
              <td><input class="form-control-sm col-sm-12 ng-pristine ng-valid ng-touched"
                [(ngModel)]="project.latitude"  type="number" step=0.00001 maxlength="6"
                (change)="onUpdateLat()" min="-90" max="90"></td>
              <td><input class="form-control-sm col-sm-12 ng-pristine ng-valid ng-touched"
                [ngModel]="Lattitude"  readonly></td>
            </tr>
            <tr>
              <td>Longitude</td>
              <td><input class="form-control-sm col-sm-12 ng-pristine ng-valid ng-touched"
                [(ngModel)]="project.longitude"  type="number" step=0.00001
                (change)="onUpdateLon()" min="-180" max="180"
                ></td>
              <td><input class="form-control-sm col-sm-12 ng-pristine ng-valid ng-touched ng-disabled"
                [ngModel]="Longitude"  readonly></td>
            </tr>
            <tr>
              <td>Water depth</td>
              <td><input class="form-control-sm col-sm-12 ng-pristine ng-valid ng-touched"
                [(ngModel)]="project.water_depth"  type="number"> m</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <agm-map id='googleMap' #gm [scaleControl]="true" [latitude]="project.latitude"
      [longitude]="project.longitude" [zoom]="8" mapTypeId="roadmap" [scrollwheel]="null"
      [streetViewControl]="false" gestureHandling="cooperative" (mapReady)="onMapReady($event)"
    ></agm-map>

    <app-vessel-location-indicator [X]="POI.X" [Y]="POI.Y" [Z]="POI.Z" [Height]="SelectedVessel?.Draft"
      [Width]="SelectedVessel?.Breadth" [Length]="SelectedVessel?.Length">
    </app-vessel-location-indicator>
  </div>
  <div class="col-md-6">
    <div class='card mb-3'>
      <div class='card-header'>
        Vessel properties
      </div>
      <div class='card-body table-responsive'>
        <table class='table table-hover table-striped'>
          <thead>
            <tr>
              <th>Vessel type</th>
              <th>
                <select name="vessel-select" [(ngModel)]="SelectedVessel" required placeholder="Please select">
                  <option disabled selected [value]="0">Please select a vessel</option>
                  <option *ngFor="let _vessel of vessels" [ngValue]="_vessel">{{_vessel.Name}}</option>
                </select>
              </th>
            </tr>
          </thead>
          <tbody class='sep-row'>
            <tr>
              <td><div [ngbTooltip]="helpLength">Length</div></td>
              <td>{{roundNumber(SelectedVessel?.Length, 10, ' m')}}</td>
            </tr>
            <tr>
              <td><div [ngbTooltip]="helpBreadth">Breadth</div></td>
              <td>{{roundNumber(SelectedVessel?.Breadth, 10, ' m')}}</td>
            </tr>
            <tr>
              <td><div [ngbTooltip]="helpDraft">Draft</div></td>
              <td>{{roundNumber(SelectedVessel?.Draft, 10, ' m')}}</td>
            </tr>
            <tr>
              <td><div [ngbTooltip]="helpGM">GM</div></td>
              <td>{{roundNumber(SelectedVessel?.GM, 10, ' m')}}</td>
            </tr>
            <tr>
              <td></td>
              <td>
                <button (click)="onRequestNewVessel()" class="btn btn-primary" [ngbTooltip]="helpRequestNewVessel">
                  Request new vessel</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class='card mb-3'>
      <div class='card-header'>
        Point of interest
      </div>
      <div class='card-body table-responsive'>
        <table class='table table-hover table-striped'>
          <thead>
            <tr>
              <th>Vessel type</th>
              <th>Here be select</th>
            </tr>
          </thead>
          <tbody class='sep-row'>
            <tr>
              <td><div [ngbTooltip]="helpX">X</div></td>
              <td><input [(ngModel)]="POI.X" type="number" step="0.5" placeholder="Distance from aft"> m</td>
            </tr>
            <tr>
              <td><div [ngbTooltip]="helpY">Y</div></td>
              <td><input [(ngModel)]="POI.Y" type="number" step="0.5" placeholder="Sideways distance"> m</td>
            </tr>
            <tr>
              <td><div [ngbTooltip]="helpZ">Z</div></td>
              <td><input [(ngModel)]="POI.Z" type="number" step="0.25" placeholder="Height from keel"> m</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <button class="btn btn-primary" (click)="onConfirm()">Confirm</button>
  </div>
</div>


<ng-template #helpLength>
  Length of the vessel
</ng-template>
<ng-template #helpBreadth>
  Breadth/width of the vessel
</ng-template>
<ng-template #helpDraft>
  Distance between waterline and keel
</ng-template>
<ng-template #helpGM>
  Metacentric height, which is the distance between the center of gravity and the vessels metacentere. 
  A larger height indicates greater stability.
</ng-template>

<ng-template #helpX>
  Distance from the aft/rear of the vessel to the point of interest. This can never be nagative or greater than the vessel length.
</ng-template>
<ng-template #helpY>
  Distance from the roll axis to the point of interest. Locations on port side are negative.
</ng-template>
<ng-template #helpZ>
  Distance from the keel to the point of interest.
</ng-template>

<ng-template #helpLon>
  Fractional input for longitude in degrees.
<ng-template #helpLat>
  Fractional input for latitude in degrees.
</ng-template>
<ng-template #helpRequestNewVessel>
  Navigates the user to a request form for adding a specific vessel type. Note: this requires 3D hull lines!
</ng-template>